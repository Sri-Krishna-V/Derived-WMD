flowchart TD
    %% =========================================
    %% DERIVED: AGENTIC GENERATIVE UI PLATFORM
    %% =========================================

    %% -------- ACTORS --------
    User["ðŸ‘¤ User / Developer"]

    Agent["ðŸ§  Tambo Agent
    Autonomous Orchestrator"]

    Firecrawl["ðŸ”¥ Firecrawl
    Web Design Scraper"]

    MCP["ðŸ”Œ MCP Server
    Model Context Protocol"]

    %% -------- SANDBOX --------
    subgraph Sandbox["ðŸ“¦ E2B Sandbox (Secure MicroVM)"]
        FS["ðŸ—‚ Project Filesystem"]
        Node["ðŸŸ¢ Node.js Runtime"]
        Vite["âš¡ Vite Dev Server
        Hot Module Replacement"]
    end

    %% -------- GENERATIVE UI --------
    subgraph UI["ðŸŽ¨ Generative UI Layer"]
        BuildStatus["ðŸ“Š BuildStatus
        Live Execution Progress"]
        Preview["ðŸ–¥ InteractableSandbox
        Live App Preview"]
    end

    %% =========================================
    %% PHASE 1: USER INPUT
    %% =========================================
    User -->|"Natural Language Prompt"| Agent

    %% =========================================
    %% PHASE 2: CONTEXT INJECTION (OPTIONAL)
    %% =========================================
    Agent -->|"URL Detected"| Firecrawl
    Firecrawl -->|"Design Manifest (Markdown)"| Agent

    %% =========================================
    %% PHASE 3: DISCOVERY & GROUNDING
    %% =========================================
    Agent -->|"list_files"| MCP
    MCP -->|"Query Filesystem"| FS
    FS -->|"File Tree"| MCP
    MCP -->|"Project Structure"| Agent

    Agent -->|"read_file (targeted)"| MCP
    MCP -->|"Read File"| FS
    FS -->|"File Contents"| MCP
    MCP -->|"Source Code"| Agent

    %% =========================================
    %% PHASE 4: EXECUTION
    %% =========================================
    Agent -->|"generateCode / installPackages"| Sandbox
    Sandbox --> Node
    Node --> FS

    %% =========================================
    %% PHASE 5: GENERATIVE FEEDBACK
    %% =========================================
    Agent -->|"Execution Steps"| BuildStatus

    FS -->|"File Changes"| Vite
    Vite -->|"HMR Update"| Preview

    %% =========================================
    %% PHASE 6: DELIVERY
    %% =========================================
    Preview -->|"State-Preserved UI"| User
